# üêõ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: –§–æ—Ç–æ —Å –ø–æ–¥–ø–∏—Å—å—é –∏ –°—Ç–∏–∫–µ—Ä—ã

## –î–∞—Ç–∞: 29.10.2025

## –ü—Ä–æ–±–ª–µ–º—ã –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã

### 1. ‚ùå –§–æ—Ç–æ —Å –ø–æ–¥–ø–∏—Å—å—é –æ—Ç–ø—Ä–∞–≤–ª—è–ª–æ—Å—å —Ç–æ–ª—å–∫–æ –∫–∞–∫ —Ç–µ–∫—Å—Ç
**–ë—ã–ª–æ:** –ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–ª —Ñ–æ—Ç–æ —Å –ø–æ–¥–ø–∏—Å—å—é, –ø—Ä–∏—Ö–æ–¥–∏–ª–∞ —Ç–æ–ª—å–∫–æ –ø–æ–¥–ø–∏—Å—å –±–µ–∑ —Å–∞–º–æ–≥–æ —Ñ–æ—Ç–æ.

**–ü—Ä–∏—á–∏–Ω–∞:** –í –∫–æ–¥–µ —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–ª—Å—è `message.text`, –∞ –ø–æ—Ç–æ–º `message.media`. –ü—Ä–∏ —Ñ–æ—Ç–æ —Å –ø–æ–¥–ø–∏—Å—å—é —É —Å–æ–æ–±—â–µ–Ω–∏—è –µ—Å—Ç—å –æ–±–∞ –ø–æ–ª—è, –ø–æ—ç—Ç–æ–º—É –∫–æ–¥ —à–µ–ª –ø–æ —Ç–µ–∫—Å—Ç–æ–≤–æ–π –≤–µ—Ç–∫–µ.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:** 
- –ò–∑–º–µ–Ω–µ–Ω–∞ –æ—á–µ—Ä–µ–¥–Ω–æ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–æ–∫ - —Å–Ω–∞—á–∞–ª–∞ `media`, –ø–æ—Ç–æ–º `text`
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ–¥–ø–∏—Å–µ–π –≤ –º–µ—Ç–æ–¥–∞—Ö `_send_photo()`, `_send_video()`, `_send_voice()`
- –¢–µ–ø–µ—Ä—å —Ç–µ–∫—Å—Ç (–ø–æ–¥–ø–∏—Å—å) –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ caption –∫ –º–µ–¥–∏–∞—Ñ–∞–π–ª—É

### 2. ‚ùå –°—Ç–∏–∫–µ—Ä –ø—Ä–∏—Ö–æ–¥–∏–ª –±–µ–∑ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
**–ë—ã–ª–æ:** –ü—Ä–∏—Ö–æ–¥–∏–ª —Ç–æ–ª—å–∫–æ —Å—Ç–∏–∫–µ—Ä –±–µ–∑ —à–∞–ø–∫–∏ (–∫—Ç–æ –æ—Ç–ø—Ä–∞–≤–∏–ª, –∫–æ–≥–¥–∞, –æ—Ç–∫—É–¥–∞).

**–ü—Ä–∏—á–∏–Ω–∞:** Telegram Bot API –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç caption –¥–ª—è —Å—Ç–∏–∫–µ—Ä–æ–≤.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- –î–ª—è —Å—Ç–∏–∫–µ—Ä–æ–≤ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞: 
  1. –°–Ω–∞—á–∞–ª–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
  2. –ó–∞—Ç–µ–º –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å–∞–º —Å—Ç–∏–∫–µ—Ä
- –î–æ–±–∞–≤–ª–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ "üì© –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–∏–ª —Å—Ç–∏–∫–µ—Ä"

## –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å –≤ –∫–æ–¥–µ

### 1. –ú–µ—Ç–æ–¥ `_handle_new_message` (—Å—Ç—Ä–æ–∫–∏ 273-283)

**–ë—ã–ª–æ:**
```python
if message.text:
    await self._send_text_notification(...)
elif message.media:
    await self._handle_media_message(...)
```

**–°—Ç–∞–ª–æ:**
```python
if message.media:
    # –ú–µ–¥–∏–∞—Ñ–∞–π–ª –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –ø–µ—Ä–≤—ã–º
    await self._handle_media_message(...)
elif message.text:
    # –¢–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç (–±–µ–∑ –º–µ–¥–∏–∞)
    await self._send_text_notification(...)
```

### 2. –ú–µ—Ç–æ–¥ `_send_photo` (—Å—Ç—Ä–æ–∫–∏ 391-414)

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
```python
# –ï—Å–ª–∏ –µ—Å—Ç—å —Ç–µ–∫—Å—Ç (–ø–æ–¥–ø–∏—Å—å –∫ —Ñ–æ—Ç–æ), –¥–æ–±–∞–≤–ª—è–µ–º –µ–≥–æ –≤ caption
full_caption = base_caption
if message.text:
    full_caption = f"{base_caption}\n<blockquote>{message.text}</blockquote>"
```

### 3. –ú–µ—Ç–æ–¥ `_send_video` (—Å—Ç—Ä–æ–∫–∏ 416-439)

**–î–æ–±–∞–≤–ª–µ–Ω–æ:** –ê–Ω–∞–ª–æ–≥–∏—á–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ–¥–ø–∏—Å–µ–π –¥–ª—è –≤–∏–¥–µ–æ

### 4. –ú–µ—Ç–æ–¥ `_send_document` (—Å—Ç—Ä–æ–∫–∏ 441-505)

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞ (—Å—Ç–∏–∫–µ—Ä –∏–ª–∏ –Ω–µ—Ç)
- –î–ª—è —Å—Ç–∏–∫–µ—Ä–æ–≤: –¥–≤—É—Ö—ç—Ç–∞–ø–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ (—Ç–µ–∫—Å—Ç + —Å—Ç–∏–∫–µ—Ä)
- –î–ª—è GIF/–¥–æ–∫—É–º–µ–Ω—Ç–æ–≤: –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ–¥–ø–∏—Å–µ–π –≤ caption

### 5. –ú–µ—Ç–æ–¥ `_send_voice` (—Å—Ç—Ä–æ–∫–∏ 507-530)

**–î–æ–±–∞–≤–ª–µ–Ω–æ:** –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ–¥–ø–∏—Å–µ–π –¥–ª—è –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–µ–ø–µ—Ä—å

### –§–æ—Ç–æ/–í–∏–¥–µ–æ/GIF —Å –ø–æ–¥–ø–∏—Å—å—é:
```
[–ú–µ–¥–∏–∞—Ñ–∞–π–ª]
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
‚úàÔ∏è TG | –ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞
üë§ –ê–≤—Ç–æ—Ä @username
üÜî 123456789
üïê 17:54 29.10.2025
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
<blockquote>–ü–æ–¥–ø–∏—Å—å –∫ —Ñ–æ—Ç–æ/–≤–∏–¥–µ–æ</blockquote>

üîó –û—Ç–∫—Ä—ã—Ç—å –ø–æ—Å—Ç
```

### –°—Ç–∏–∫–µ—Ä:
```
–°–æ–æ–±—â–µ–Ω–∏–µ 1 (—Ç–µ–∫—Å—Ç):
‚úàÔ∏è TG | –ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞
üë§ –ê–≤—Ç–æ—Ä @username
üÜî 123456789
üïê 17:54 29.10.2025
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

üì© –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–∏–ª —Å—Ç–∏–∫–µ—Ä

üîó –û—Ç–∫—Ä—ã—Ç—å –ø–æ—Å—Ç

–°–æ–æ–±—â–µ–Ω–∏–µ 2 (—Å—Ç–∏–∫–µ—Ä):
[–°–∞–º —Å—Ç–∏–∫–µ—Ä]
```

## –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –Ω–∞ –í–ú

### –ï—Å–ª–∏ –≤—ã –£–ñ–ï –ø—Ä–∏–º–µ–Ω–∏–ª–∏ –ø–µ—Ä–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:

```bash
# 1. –ù–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ –∑–∞–∫–æ–º–º–∏—Ç—å—Ç–µ
git add worker.py BUGFIX_PHOTO_STICKER.md
git commit -m "fix: —Ñ–æ—Ç–æ —Å –ø–æ–¥–ø–∏—Å—å—é –∏ —Å—Ç–∏–∫–µ—Ä—ã —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ"
git push origin main

# 2. –ù–∞ –í–ú
ssh your-user@your-vm-ip
cd ~/monitorshik

# 3. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–∏—Å
sudo systemctl stop telegram-monitor

# 4. –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥
git pull origin main

# 5. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å
sudo systemctl start telegram-monitor

# 6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
sudo journalctl -u telegram-monitor -f
```

### –ï—Å–ª–∏ –µ—â–µ –ù–ï –ø—Ä–∏–º–µ–Ω—è–ª–∏ –ø–µ—Ä–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:

–°–Ω–∞—á–∞–ª–∞ –ø—Ä–∏–º–µ–Ω–∏—Ç–µ –æ—Å–Ω–æ–≤–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ `DEPLOYMENT_GUIDE.md`, –∑–∞—Ç–µ–º —ç—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ.

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ:

1. ‚úÖ **–§–æ—Ç–æ —Å –ø–æ–¥–ø–∏—Å—å—é** 
   - –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ñ–æ—Ç–æ —Å —Ç–µ–∫—Å—Ç–æ–º
   - –î–æ–ª–∂–Ω–æ –ø—Ä–∏–π—Ç–∏ —Ñ–æ—Ç–æ + –ø–æ–¥–ø–∏—Å—å –≤ blockquote

2. ‚úÖ **–í–∏–¥–µ–æ —Å –ø–æ–¥–ø–∏—Å—å—é**
   - –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ—Ä–æ—Ç–∫–æ–µ –≤–∏–¥–µ–æ —Å —Ç–µ–∫—Å—Ç–æ–º
   - –î–æ–ª–∂–Ω–æ –ø—Ä–∏–π—Ç–∏ –≤–∏–¥–µ–æ + –ø–æ–¥–ø–∏—Å—å

3. ‚úÖ **–°—Ç–∏–∫–µ—Ä**
   - –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å—Ç–∏–∫–µ—Ä
   - –î–æ–ª–∂–Ω–æ –ø—Ä–∏–π—Ç–∏ 2 —Å–æ–æ–±—â–µ–Ω–∏—è: –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è + —Å—Ç–∏–∫–µ—Ä

4. ‚úÖ **GIF**
   - –û—Ç–ø—Ä–∞–≤—å—Ç–µ GIF
   - –î–æ–ª–∂–µ–Ω –ø—Ä–∏–π—Ç–∏ GIF —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –≤ caption

5. ‚úÖ **–¢–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç** (–±–µ–∑ –º–µ–¥–∏–∞)
   - –î–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ —Ä–∞–Ω—å—à–µ

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

- –ö–æ–¥ —Å—Ç–∞–ª –¥–ª–∏–Ω–Ω–µ–µ –Ω–∞ ~20 —Å—Ç—Ä–æ–∫
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ `message.text` –≤ 4 –º–µ—Ç–æ–¥–∞—Ö
- –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –¥–ª—è —Å—Ç–∏–∫–µ—Ä–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç 2 HTTP-–∑–∞–ø—Ä–æ—Å–∞ –≤–º–µ—Å—Ç–æ –æ–¥–Ω–æ–≥–æ
- –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ–±—Ä–∞—Ç–Ω–æ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã

## –°—Ç–∞—Ç—É—Å

‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ**
- –§–æ—Ç–æ —Å –ø–æ–¥–ø–∏—Å—å—é —Ä–∞–±–æ—Ç–∞–µ—Ç
- –í–∏–¥–µ–æ —Å –ø–æ–¥–ø–∏—Å—å—é —Ä–∞–±–æ—Ç–∞–µ—Ç
- –°—Ç–∏–∫–µ—Ä—ã –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
- GIF –∏ –¥–æ–∫—É–º–µ–Ω—Ç—ã –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –ø–æ–¥–ø–∏—Å–∏
- –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞

**–í–µ—Ä—Å–∏—è:** 1.1.1
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –°—Ä–µ–¥–Ω–∏–π (–∫–æ—Å–º–µ—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ)
**–¢–∏–ø:** Bugfix

