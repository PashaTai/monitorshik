# –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ worker.py

## –î–∞—Ç–∞: 29.10.2025

### –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

#### 1. –ù–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
–û–±–Ω–æ–≤–ª–µ–Ω —Ñ–æ—Ä–º–∞—Ç –≤—Å–µ—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –Ω–∞ –±–æ–ª–µ–µ –∫–æ–º–ø–∞–∫—Ç–Ω—ã–π –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π:

```
‚úàÔ∏è TG | –ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞
üë§ –ò–º—è –ê–≤—Ç–æ—Ä–∞ @username
üÜî 123456789
üïê 17:54 29.10.2025
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
[–°–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è]

üîó –û—Ç–∫—Ä—ã—Ç—å –ø–æ—Å—Ç
```

#### 2. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤
–¢–µ–ø–µ—Ä—å –±–æ—Ç —É–º–µ–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –º–µ–¥–∏–∞—Ñ–∞–π–ª—ã –∏–∑ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤:

**–û—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é:**
- üì∑ –§–æ—Ç–æ (–ª—é–±–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞)
- üé• –í–∏–¥–µ–æ (–¥–æ 10 –ú–ë)
- üñºÔ∏è –°—Ç–∏–∫–µ—Ä—ã
- üé¨ GIF –∏ –∞–Ω–∏–º–∞—Ü–∏–∏
- üé§ –ì–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- üéµ –ê—É–¥–∏–æ—Ñ–∞–π–ª—ã

**–î–ª—è —Ç—è–∂–µ–ª—ã—Ö —Ñ–∞–π–ª–æ–≤ (–≤–∏–¥–µ–æ > 10 –ú–ë):**
–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å –ø—Ä–æ—Å—å–±–æ–π –æ—Ç–∫—Ä—ã—Ç—å –ø–æ—Å—Ç.

#### 3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
–ï—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å —Å–∫–∞—á–∞—Ç—å –∏–ª–∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –º–µ–¥–∏–∞—Ñ–∞–π–ª, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å –ø—Ä–æ—Å—å–±–æ–π –æ—Ç–∫—Ä—ã—Ç—å –ø–æ—Å—Ç –≤—Ä—É—á–Ω—É—é.

#### 4. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏
–í—Å–µ –º–µ–¥–∏–∞—Ñ–∞–π–ª—ã —Å–∫–∞—á–∏–≤–∞—é—Ç—Å—è –≤ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω—É—é –ø–∞–º—è—Ç—å (BytesIO), –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –Ω–∞ –¥–∏—Å–∫ –í–ú.

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

#### –ù–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã:
- `_format_base_caption()` - —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –±–∞–∑–æ–≤—É—é —á–∞—Å—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- `_send_text_notification()` - –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- `_send_fallback_notification()` - –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç fallback –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- `_handle_media_message()` - –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–∏–ø –º–µ–¥–∏–∞ –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –µ–≥–æ
- `_send_photo()` - —Å–∫–∞—á–∏–≤–∞–µ—Ç –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ñ–æ—Ç–æ
- `_send_video()` - —Å–∫–∞—á–∏–≤–∞–µ—Ç –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤–∏–¥–µ–æ
- `_send_document()` - —Å–∫–∞—á–∏–≤–∞–µ—Ç –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç—ã/—Å—Ç–∏–∫–µ—Ä—ã/GIF
- `_send_voice()` - —Å–∫–∞—á–∏–≤–∞–µ—Ç –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≥–æ–ª–æ—Å–æ–≤—ã–µ
- `_send_media_to_bot()` - —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –º–µ—Ç–æ–¥ –æ—Ç–ø—Ä–∞–≤–∫–∏ –º–µ–¥–∏–∞ —á–µ—Ä–µ–∑ Bot API

#### –ù–æ–≤—ã–µ –∏–º–ø–æ—Ä—Ç—ã:
- `from io import BytesIO` - –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–π—Ç–∞–º–∏ –≤ –ø–∞–º—è—Ç–∏
- `MessageMediaPhoto, MessageMediaDocument` –∏–∑ telethon - –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–∞ –º–µ–¥–∏–∞

### –ö–∞–∫ –æ—Ç–∫–∞—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫:

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–∏—Å
sudo systemctl stop telegram-monitor

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ –±–µ–∫–∞–ø–∞ (–µ—Å–ª–∏ –±—ã–ª —Å–æ–∑–¥–∞–Ω)
cp worker.py.backup worker.py

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å
sudo systemctl start telegram-monitor
```

### –ö–∞–∫ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞ –í–ú

```bash
# 1. –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –í–ú
ssh your-vm

# 2. –ü–µ—Ä–µ–π—Ç–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
cd ~/monitorshik  # –∏–ª–∏ –≤–∞—à –ø—É—Ç—å

# 3. –°–æ–∑–¥–∞—Ç—å –±–µ–∫–∞–ø —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏
cp worker.py worker.py.backup

# 4. –°–∫–∞—á–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
git pull origin main

# 5. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å
sudo systemctl restart telegram-monitor

# 6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
sudo journalctl -u telegram-monitor -f
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ:

1. **–¢–µ–∫—Å—Ç–æ–≤—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π** - –¥–æ–ª–∂–µ–Ω –ø—Ä–∏–π—Ç–∏ —Å –Ω–æ–≤—ã–º —Ñ–æ—Ä–º–∞—Ç–æ–º –∏ blockquote
2. **–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å —Ñ–æ—Ç–æ** - —Ñ–æ—Ç–æ –¥–æ–ª–∂–Ω–æ –ø—Ä–∏–π—Ç–∏ —Å caption
3. **–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å –≤–∏–¥–µ–æ < 10 –ú–ë** - –≤–∏–¥–µ–æ –¥–æ–ª–∂–Ω–æ –ø—Ä–∏–π—Ç–∏
4. **–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å –≤–∏–¥–µ–æ > 10 –ú–ë** - –¥–æ–ª–∂–Ω–æ –ø—Ä–∏–π—Ç–∏ —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
5. **–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å–æ —Å—Ç–∏–∫–µ—Ä–æ–º** - —Å—Ç–∏–∫–µ—Ä –¥–æ–ª–∂–µ–Ω –ø—Ä–∏–π—Ç–∏ –∫–∞–∫ –¥–æ–∫—É–º–µ–Ω—Ç
6. **–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å –≥–æ–ª–æ—Å–æ–≤—ã–º** - –≥–æ–ª–æ—Å–æ–≤–æ–µ –¥–æ–ª–∂–Ω–æ –ø—Ä–∏–π—Ç–∏

